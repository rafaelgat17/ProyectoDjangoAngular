<div class="bloque-container">
  <h1>Ejercicio Bloque {{ bloqueId }}</h1>

  <div class="ejercicio-section">
    <h2>Ejercicio</h2>
    
    <div class="controles">
      <div class="control-group">
        <label for="rows">Filas (2-6):</label>
        <input type="number" id="rows" [(ngModel)]="rows" min="2" max="6" [disabled]="cargando">
      </div>
      
      <div class="control-group">
        <label for="cols">Columnas (2-6):</label>
        <input type="number" id="cols" [(ngModel)]="cols" min="2" max="6" [disabled]="cargando">
      </div>
    </div>
    
    <!-- ngModel: actualiza el valor de rows y cols cuando el usuario cambia el valor -->

    <button class="btn-generar" (click)="generarEjercicio()" 
            [disabled]="cargando">
      <span *ngIf="!cargando">Generar ejercicio ({{ rows }}x{{ cols }})</span>
      <span *ngIf="cargando">Generando...</span>
    </button>
    <!-- ngIf: si NO esta cargando "!cargando" saldra tal mensaje y cuando SI esta cargando saldra otro -->

    
    <div *ngIf="cargando" class="loading">
      <div class="spinner"></div>
      <p>Generando circuito {{ rows }}x{{ cols }}...</p>
    </div>




    <div *ngIf="circuitoGenerado && !cargando && circuitoGenerado.success" class="resultado">

      <div class="imagen-circuito">
        <app-circuit-viewer [circuitData]="circuitoGenerado.circuito"></app-circuit-viewer>
      </div>

      <div class="preguntas-section" *ngIf="circuitoGenerado && !cargando">
        <h3>Preguntas sobre el circuito</h3>
        <p class="preguntas-instruccion">
          Calcula los valores solicitados del circuito generado:
        </p>
        
        <div class="preguntas-grid">
          
          <div class="pregunta-item">
            <label for="pregunta1">
              <span class="pregunta-numero">1.</span>
              Pregunta 1:
            </label>
            <div class="input-div">
              <input 
                type="number" 
                id="pregunta1" 
                [(ngModel)]="respuestas.pregunta1"
                placeholder="0.00"
                step="0.01">
              <span class="input-unit">V</span>
            </div>
          </div>
          
          <div class="pregunta-item">
            <label for="pregunta2">
              <span class="pregunta-numero">2.</span>
              Pregunta 2:
            </label>
            <div class="input-div">
              <input 
                type="number" 
                id="pregunta2" 
                [(ngModel)]="respuestas.pregunta2"
                placeholder="0.00"
                step="0.01">
              <span class="input-unit">A</span>
            </div>
          </div>
          
          <div class="pregunta-item">
            <label for="pregunta3">
              <span class="pregunta-numero">3.</span>
              Pregunta 3:
            </label>
            <div class="input-div">
              <input 
                type="number" 
                id="pregunta3" 
                [(ngModel)]="respuestas.pregunta3"
                placeholder="0.00"
                step="0.01">
              <span class="input-unit">W</span>
            </div>
          </div>
          
        </div>
        
        <div class="preguntas-acciones">
          <button class="btn-comprobar" (click)="comprobarRespuestas()">
            Comprobar Respuestas
          </button>
          <button class="btn-limpiar" (click)="limpiarRespuestas()">
            Limpiar
          </button>
        </div>
        
        <div class="resultado-preguntas" *ngIf="resultadoVisible">
          <p class="resultado-mensaje">
            {{ mensajeResultado }}
          </p>
        </div>
        
      </div>

    <div *ngIf="circuitoGenerado && !circuitoGenerado.success" class="error">
      <h3>Error</h3>
      <p>{{ circuitoGenerado.mensaje }}</p>
      <p class="error-detail">{{ circuitoGenerado.error }}</p>
    </div>
  </div>
</div>